{"version":3,"sources":["FileList.js"],"names":["FileItem","require","VirtualList","classNames","h","chunks","list","size","chunked","currentChunk","forEach","item","i","length","push","module","exports","props","noFiles","totalFileCount","dashboardFilesClass","rowHeight","itemsPerRow","fileProps","id","error","i18n","log","info","acquirers","resumableUploads","individualCancellation","hideRetryButton","hidePauseResumeButton","hideCancelButton","showLinkToFileUploadResult","showRemoveButtonAfterComplete","isWide","metaFields","recoveredState","retryUpload","pauseUpload","cancelUpload","toggleFileCard","removeFile","handleRequestThumbnail","handleCancelThumbnail","sortByGhostComesFirst","file1","file2","files","isGhost","Object","keys","sort","rows","renderRow","row","map","fileID","openFileEditor","canEditFile","toggleAddFilesPanel"],"mappings":"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","sourcesContent":["const FileItem = require('./FileItem/index.js')\nconst VirtualList = require('./VirtualList')\nconst classNames = require('classnames')\nconst { h } = require('preact')\n\nfunction chunks (list, size) {\n  const chunked = []\n  let currentChunk = []\n  list.forEach((item, i) => {\n    if (currentChunk.length < size) {\n      currentChunk.push(item)\n    } else {\n      chunked.push(currentChunk)\n      currentChunk = [item]\n    }\n  })\n  if (currentChunk.length) chunked.push(currentChunk)\n  return chunked\n}\n\nmodule.exports = (props) => {\n  const noFiles = props.totalFileCount === 0\n  const dashboardFilesClass = classNames(\n    'uppy-Dashboard-files',\n    { 'uppy-Dashboard-files--noFiles': noFiles }\n  )\n\n  // It's not great that this is hardcoded!\n  // It's ESPECIALLY not great that this is checking against `itemsPerRow`!\n  const rowHeight = props.itemsPerRow === 1\n    // Mobile\n    ? 71\n    // 190px height + 2 * 5px margin\n    : 200\n\n  const fileProps = {\n    // FIXME This is confusing, it's actually the Dashboard's plugin ID\n    id: props.id,\n    error: props.error,\n    // TODO move this to context\n    i18n: props.i18n,\n    log: props.log,\n    info: props.info,\n    // features\n    acquirers: props.acquirers,\n    resumableUploads: props.resumableUploads,\n    individualCancellation: props.individualCancellation,\n    // visual options\n    hideRetryButton: props.hideRetryButton,\n    hidePauseResumeButton: props.hidePauseResumeButton,\n    hideCancelButton: props.hideCancelButton,\n    showLinkToFileUploadResult: props.showLinkToFileUploadResult,\n    showRemoveButtonAfterComplete: props.showRemoveButtonAfterComplete,\n    isWide: props.isWide,\n    metaFields: props.metaFields,\n    recoveredState: props.recoveredState,\n    // callbacks\n    retryUpload: props.retryUpload,\n    pauseUpload: props.pauseUpload,\n    cancelUpload: props.cancelUpload,\n    toggleFileCard: props.toggleFileCard,\n    removeFile: props.removeFile,\n    handleRequestThumbnail: props.handleRequestThumbnail,\n    handleCancelThumbnail: props.handleCancelThumbnail,\n  }\n\n  const sortByGhostComesFirst = (file1, file2) => {\n    return props.files[file2].isGhost - props.files[file1].isGhost\n  }\n\n  // Sort files by file.isGhost, ghost files first, only if recoveredState is present\n  const files = Object.keys(props.files)\n  if (props.recoveredState) files.sort(sortByGhostComesFirst)\n  const rows = chunks(files, props.itemsPerRow)\n\n  function renderRow (row) {\n    return (\n      // The `role=\"presentation` attribute ensures that the list items are properly associated with the `VirtualList` element\n      // We use the first file ID as the keyâ€”this should not change across scroll rerenders\n      <div role=\"presentation\" key={row[0]}>\n        {row.map((fileID) => (\n          <FileItem\n            key={fileID}\n            {...fileProps}\n            role=\"listitem\"\n            openFileEditor={props.openFileEditor}\n            canEditFile={props.canEditFile}\n            toggleAddFilesPanel={props.toggleAddFilesPanel}\n            file={props.files[fileID]}\n          />\n        ))}\n      </div>\n    )\n  }\n\n  return (\n    <VirtualList\n      class={dashboardFilesClass}\n      role=\"list\"\n      data={rows}\n      renderRow={renderRow}\n      rowHeight={rowHeight}\n    />\n  )\n}\n"]}