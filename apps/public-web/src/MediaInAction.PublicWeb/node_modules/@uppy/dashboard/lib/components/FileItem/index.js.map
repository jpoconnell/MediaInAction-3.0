{"version":3,"sources":["index.js"],"names":["require","h","Component","classNames","shallowEqual","FilePreviewAndLink","FileProgress","FileInfo","Buttons","module","exports","shouldComponentUpdate","nextProps","props","componentDidMount","file","preview","handleRequestThumbnail","componentDidUpdate","componentWillUnmount","handleCancelThumbnail","render","isProcessing","progress","preprocess","postprocess","isUploaded","uploadComplete","error","uploadInProgressOrComplete","uploadStarted","uploadInProgress","isGhost","showRemoveButton","individualCancellation","showRemoveButtonAfterComplete","dashboardItemClass","recoveredState","resumableUploads","id","role","showLinkToFileUploadResult","hideRetryButton","hideCancelButton","hidePauseResumeButton","pauseUpload","cancelUpload","retryUpload","i18n","acquirers","containerWidth","toggleAddFilesPanel","metaFields","canEditFile","removeFile","toggleFileCard","openFileEditor","log","info"],"mappings":"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","sourcesContent":["const { h, Component } = require('preact')\nconst classNames = require('classnames')\nconst shallowEqual = require('is-shallow-equal')\nconst FilePreviewAndLink = require('./FilePreviewAndLink')\nconst FileProgress = require('./FileProgress')\nconst FileInfo = require('./FileInfo')\nconst Buttons = require('./Buttons')\n\nmodule.exports = class FileItem extends Component {\n  shouldComponentUpdate (nextProps) {\n    return !shallowEqual(this.props, nextProps)\n  }\n\n  componentDidMount () {\n    const file = this.props.file\n    if (!file.preview) {\n      this.props.handleRequestThumbnail(file)\n    }\n  }\n\n  // VirtualList mounts FileItems again and they emit `thumbnail:request`\n  // Otherwise thumbnails are broken or missing after Golden Retriever restores files\n  componentDidUpdate () {\n    const file = this.props.file\n    if (!file.preview) {\n      this.props.handleRequestThumbnail(file)\n    }\n  }\n\n  componentWillUnmount () {\n    const file = this.props.file\n    if (!file.preview) {\n      this.props.handleCancelThumbnail(file)\n    }\n  }\n\n  render () {\n    const file = this.props.file\n\n    const isProcessing = file.progress.preprocess || file.progress.postprocess\n    const isUploaded = file.progress.uploadComplete && !isProcessing && !file.error\n    const uploadInProgressOrComplete = file.progress.uploadStarted || isProcessing\n    const uploadInProgress = (file.progress.uploadStarted && !file.progress.uploadComplete) || isProcessing\n    const error = file.error || false\n\n    // File that Golden Retriever was able to partly restore (only meta, not blob),\n    // users still need to re-add it, so itâ€™s a ghost\n    const isGhost = file.isGhost\n\n    let showRemoveButton = this.props.individualCancellation\n      ? !isUploaded\n      : !uploadInProgress && !isUploaded\n\n    if (isUploaded && this.props.showRemoveButtonAfterComplete) {\n      showRemoveButton = true\n    }\n\n    const dashboardItemClass = classNames({\n      'uppy-Dashboard-Item': true,\n      'is-inprogress': uploadInProgress && !this.props.recoveredState,\n      'is-processing': isProcessing,\n      'is-complete': isUploaded,\n      'is-error': !!error,\n      'is-resumable': this.props.resumableUploads,\n      'is-noIndividualCancellation': !this.props.individualCancellation,\n      'is-ghost': isGhost,\n    })\n\n    return (\n      <div\n        className={dashboardItemClass}\n        id={`uppy_${file.id}`}\n        role={this.props.role}\n      >\n        <div className=\"uppy-Dashboard-Item-preview\">\n          <FilePreviewAndLink\n            file={file}\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\n          />\n          <FileProgress\n            file={file}\n            error={error}\n            isUploaded={isUploaded}\n            hideRetryButton={this.props.hideRetryButton}\n            hideCancelButton={this.props.hideCancelButton}\n            hidePauseResumeButton={this.props.hidePauseResumeButton}\n            recoveredState={this.props.recoveredState}\n            showRemoveButtonAfterComplete={this.props.showRemoveButtonAfterComplete}\n            resumableUploads={this.props.resumableUploads}\n            individualCancellation={this.props.individualCancellation}\n            pauseUpload={this.props.pauseUpload}\n            cancelUpload={this.props.cancelUpload}\n            retryUpload={this.props.retryUpload}\n            i18n={this.props.i18n}\n          />\n        </div>\n\n        <div className=\"uppy-Dashboard-Item-fileInfoAndButtons\">\n          <FileInfo\n            file={file}\n            id={this.props.id}\n            acquirers={this.props.acquirers}\n            containerWidth={this.props.containerWidth}\n            i18n={this.props.i18n}\n            toggleAddFilesPanel={this.props.toggleAddFilesPanel}\n          />\n          <Buttons\n            file={file}\n            metaFields={this.props.metaFields}\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\n            showRemoveButton={showRemoveButton}\n            canEditFile={this.props.canEditFile}\n            uploadInProgressOrComplete={uploadInProgressOrComplete}\n            removeFile={this.props.removeFile}\n            toggleFileCard={this.props.toggleFileCard}\n            openFileEditor={this.props.openFileEditor}\n            i18n={this.props.i18n}\n            log={this.props.log}\n            info={this.props.info}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n"]}